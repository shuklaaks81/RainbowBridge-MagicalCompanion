<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåà‚ú® Rainbow Bridge: Magical Companion ‚ú®üåà</title>
    <style>
        /* Sensory-friendly design principles with rainbow theme */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 20%, #fecfef 40%, #a8edea 60%, #fed6e3 80%, #d299c2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #4a90e2;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            color: #666;
            font-size: 1.2rem;
        }

        .main-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .action-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 3px solid transparent;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            border-color: #4a90e2;
        }

        .action-card .icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .action-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .action-card p {
            color: #666;
            margin-bottom: 20px;
        }

        .btn {
            display: inline-block;
            padding: 15px 30px;
            background: #4a90e2;
            color: white;
            text-decoration: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            transition: background 0.3s ease;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .btn:hover {
            background: #357abd;
        }

        .btn-secondary {
            background: #50c878;
            box-shadow: 0 4px 15px rgba(80, 200, 120, 0.3);
        }

        .btn-secondary:hover {
            background: #45b069;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .feature {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .feature .icon {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #4a90e2;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

        .close:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .children-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .child-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .child-card h4 {
            color: #4a90e2;
            margin-bottom: 10px;
        }

        .child-card p {
            color: #666;
            margin-bottom: 15px;
        }

        /* Enhanced Demo Section Styles */
        .demo-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 40px 30px;
            border-radius: 20px;
            margin: 40px 0;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-header h2 {
            color: #4a90e2;
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .section-header p {
            color: #666;
            font-size: 1.2rem;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }

        .demo-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .demo-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff9a9e, #fecfef, #a8edea, #fed6e3);
        }

        .demo-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border-color: #4a90e2;
        }

        .demo-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            animation: gentle-bounce 3s ease-in-out infinite;
        }

        @keyframes gentle-bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .demo-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .demo-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .demo-preview {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #e0e6ff;
        }

        .schedule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .schedule-item:last-child {
            border-bottom: none;
        }

        .time {
            font-weight: bold;
            color: #4a90e2;
            font-size: 0.9rem;
        }

        .activity {
            color: #666;
            font-size: 0.9rem;
        }

        .communication-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .comm-card {
            background: white;
            padding: 15px 10px;
            border-radius: 8px;
            font-size: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .comm-card:hover {
            transform: scale(1.1);
        }

        .routine-steps {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .step {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: left;
            font-size: 0.9rem;
            color: #555;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .progress-bar {
            background: #e0e6ff;
            border-radius: 20px;
            height: 30px;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #50c878, #4a90e2);
            height: 100%;
            border-radius: 20px;
            position: relative;
            transition: width 0.3s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .achievements {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .badge {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .demo-btn {
            margin-top: 15px;
            background: linear-gradient(135deg, #4a90e2, #50c878);
            position: relative;
            overflow: hidden;
        }

        .demo-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .demo-btn:hover::before {
            left: 100%;
        }

        /* Demo Modal Styles */
        .demo-modal {
            background: rgba(0, 0, 0, 0.8);
        }

        .demo-modal .modal-content {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #a8edea 100%);
            color: white;
            text-align: center;
            max-width: 600px;
        }

        .demo-interactive {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            color: #333;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .main-actions {
                grid-template-columns: 1fr;
            }
            
            .action-card {
                padding: 20px;
            }

            .demo-grid {
                grid-template-columns: 1fr;
            }

            .demo-card {
                padding: 20px;
            }

            .section-header h2 {
                font-size: 1.8rem;
            }

            .communication-cards {
                grid-template-columns: repeat(2, 1fr) !important;
            }

            .modal-content {
                width: 95%;
                margin: 2% auto;
                padding: 20px;
            }

            .demo-interactive {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .header p {
                font-size: 1rem;
            }

            .demo-section {
                padding: 20px 15px;
            }

            .communication-cards {
                grid-template-columns: 1fr !important;
            }

            .comm-card {
                padding: 15px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåà‚ú® Rainbow Bridge: Magical Companion ‚ú®üåà</h1>
            <p>Your colorful companion for communication and learning adventures</p>
        </div>

        <div class="main-actions">
            <div class="action-card">
                <span class="icon">üë∂</span>
                <h3>Create Child Profile</h3>
                <p>Set up a personalized profile for your child to get started with customized support and learning activities.</p>
                <button class="btn" onclick="openModal('childModal')">Create Profile</button>
            </div>

            <div class="action-card">
                <span class="icon">üè†</span>
                <h3>View Children</h3>
                <p>Access existing child profiles to continue their learning journey and track their progress.</p>
                <button class="btn btn-secondary" onclick="loadChildren()">View Children</button>
            </div>

            <div class="action-card">
                <span class="icon">üåà</span>
                <h3>About Rainbow Bridge</h3>
                <p>Learn more about how our colorful companion helps children with communication and learning adventures.</p>
                <button class="btn" onclick="openModal('aboutModal')">Learn More</button>
            </div>

            <div class="action-card">
                <span class="icon">ü§ñ</span>
                <h3>LLM Settings</h3>
                <p>Configure local AI providers for enhanced privacy and offline functionality.</p>
                <a href="/admin/llm" class="btn btn-secondary">Manage AI</a>
            </div>
        </div>

        <!-- Enhanced Interactive Demo Section -->
        <div class="demo-section">
            <div class="section-header">
                <h2>üé™ Experience the Magic - Interactive Demos</h2>
                <p>Try our features in a safe, friendly environment</p>
            </div>
            
            <div class="demo-grid">
                <div class="demo-card smart-schedule">
                    <div class="demo-icon">üåÖ</div>
                    <h3>Smart Daily Schedules</h3>
                    <p>Watch AI create perfect daily routines tailored for your child</p>
                    <div class="demo-preview">
                        <div class="schedule-item">
                            <span class="time">8:00 AM</span>
                            <span class="activity">ü•û Gentle Breakfast Time</span>
                        </div>
                        <div class="schedule-item">
                            <span class="time">9:00 AM</span>
                            <span class="activity">üé® Creative Art Session</span>
                        </div>
                        <div class="schedule-item">
                            <span class="time">10:00 AM</span>
                            <span class="activity">üå≥ Nature Walk</span>
                        </div>
                    </div>
                    <button class="btn demo-btn" onclick="startSmartScheduleDemo()">Try Smart Schedule</button>
                </div>

                <div class="demo-card communication">
                    <div class="demo-icon">üí¨</div>
                    <h3>Visual Communication</h3>
                    <p>Explore colorful cards and symbols that help express feelings</p>
                    <div class="demo-preview">
                        <div class="communication-cards">
                            <div class="comm-card happy">üòä</div>
                            <div class="comm-card hungry">üçé</div>
                            <div class="comm-card tired">üò¥</div>
                            <div class="comm-card play">üéÆ</div>
                        </div>
                    </div>
                    <button class="btn demo-btn" onclick="startCommunicationDemo()">Explore Cards</button>
                </div>

                <div class="demo-card routine">
                    <div class="demo-icon">üè†</div>
                    <h3>Routine Builder</h3>
                    <p>Create step-by-step visual guides for daily activities</p>
                    <div class="demo-preview">
                        <div class="routine-steps">
                            <div class="step">1Ô∏è‚É£ Brush Teeth</div>
                            <div class="step">2Ô∏è‚É£ Put on Pajamas</div>
                            <div class="step">3Ô∏è‚É£ Read Story</div>
                            <div class="step">4Ô∏è‚É£ Sleep Time</div>
                        </div>
                    </div>
                    <button class="btn demo-btn" onclick="startRoutineDemo()">Build Routine</button>
                </div>

                <div class="demo-card progress">
                    <div class="demo-icon">üìà</div>
                    <h3>Progress Celebration</h3>
                    <p>Watch achievements grow and celebrate every success</p>
                    <div class="demo-preview">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 75%">
                                <span class="progress-text">‚ú® 75% Complete!</span>
                            </div>
                        </div>
                        <div class="achievements">
                            <span class="badge">üèÜ Daily Routine</span>
                            <span class="badge">‚≠ê Communication</span>
                        </div>
                    </div>
                    <button class="btn demo-btn" onclick="startProgressDemo()">See Progress</button>
                </div>
            </div>
        </div>

        <div class="features">
            <div class="feature">
                <div class="icon">üéØ</div>
                <h4>Personalized Learning</h4>
                <p>Adapts to each child's unique communication style and learning pace</p>
            </div>
            <div class="feature">
                <div class="icon">üìÖ</div>
                <h4>Routine Support</h4>
                <p>Helps establish and maintain daily routines with visual schedules</p>
            </div>
            <div class="feature">
                <div class="icon">üó£Ô∏è</div>
                <h4>Communication Tools</h4>
                <p>Visual cards, symbols, and alternative communication methods</p>
            </div>
            <div class="feature">
                <div class="icon">üìä</div>
                <h4>Progress Tracking</h4>
                <p>Monitors development and provides insights for caregivers</p>
            </div>
        </div>

        <div id="childrenList" class="children-list"></div>
    </div>

    <!-- Enhanced Demo Modals -->
    <div id="smartScheduleModal" class="modal demo-modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('smartScheduleModal')">&times;</span>
            <h2>üåÖ Smart Schedule Demo</h2>
            <div class="demo-interactive">
                <p><strong>Ask me to create a schedule!</strong></p>
                <div class="form-group">
                    <input type="text" id="scheduleRequest" placeholder="e.g., 'Plan my morning with calm activities'" style="margin-bottom: 15px;">
                    <button class="btn" onclick="generateDemoSchedule()">Create Schedule</button>
                </div>
                <div id="scheduleResult" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <div id="communicationModal" class="modal demo-modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('communicationModal')">&times;</span>
            <h2>üí¨ Communication Cards Demo</h2>
            <div class="demo-interactive">
                <p><strong>Click the cards to express feelings!</strong></p>
                <div class="communication-cards" style="grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0;">
                    <div class="comm-card" onclick="playCardSound('happy')" style="padding: 20px;">üòä<br><small>Happy</small></div>
                    <div class="comm-card" onclick="playCardSound('sad')" style="padding: 20px;">üò¢<br><small>Sad</small></div>
                    <div class="comm-card" onclick="playCardSound('hungry')" style="padding: 20px;">üçé<br><small>Hungry</small></div>
                    <div class="comm-card" onclick="playCardSound('tired')" style="padding: 20px;">üò¥<br><small>Tired</small></div>
                    <div class="comm-card" onclick="playCardSound('play')" style="padding: 20px;">üéÆ<br><small>Play</small></div>
                    <div class="comm-card" onclick="playCardSound('help')" style="padding: 20px;">ü§ù<br><small>Help</small></div>
                </div>
                <div id="cardFeedback" style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 10px;"></div>
            </div>
        </div>
    </div>

    <div id="routineModal" class="modal demo-modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('routineModal')">&times;</span>
            <h2>üè† Routine Builder Demo</h2>
            <div class="demo-interactive">
                <p><strong>Build a bedtime routine!</strong></p>
                <div class="routine-builder">
                    <div id="routineSteps">
                        <div class="step" onclick="completeStep(this)">1Ô∏è‚É£ Brush Teeth <span style="float: right;">‚≠ï</span></div>
                        <div class="step" onclick="completeStep(this)">2Ô∏è‚É£ Put on Pajamas <span style="float: right;">‚≠ï</span></div>
                        <div class="step" onclick="completeStep(this)">3Ô∏è‚É£ Read Story <span style="float: right;">‚≠ï</span></div>
                        <div class="step" onclick="completeStep(this)">4Ô∏è‚É£ Sleep Time <span style="float: right;">‚≠ï</span></div>
                    </div>
                    <div id="routineProgress" style="margin-top: 20px;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="routineProgressFill" style="width: 0%">
                                <span class="progress-text" id="routineProgressText">0% Complete</span>
                            </div>
                        </div>
                    </div>
                    <button class="btn" onclick="resetRoutine()" style="margin-top: 15px;">Start Over</button>
                </div>
            </div>
        </div>
    </div>

    <div id="progressModal" class="modal demo-modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('progressModal')">&times;</span>
            <h2>üìà Progress Celebration Demo</h2>
            <div class="demo-interactive">
                <p><strong>Watch your achievements grow!</strong></p>
                <div class="progress-showcase">
                    <h4>Daily Goals</h4>
                    <div class="progress-bar" style="margin: 10px 0;">
                        <div class="progress-fill" style="width: 80%">
                            <span class="progress-text">Communication: 80%</span>
                        </div>
                    </div>
                    <div class="progress-bar" style="margin: 10px 0;">
                        <div class="progress-fill" style="width: 65%">
                            <span class="progress-text">Routine: 65%</span>
                        </div>
                    </div>
                    <div class="progress-bar" style="margin: 10px 0;">
                        <div class="progress-fill" style="width: 90%">
                            <span class="progress-text">Social Skills: 90%</span>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 25px;">Recent Achievements</h4>
                    <div class="achievements" style="margin: 15px 0;">
                        <span class="badge">üåü First Words</span>
                        <span class="badge">üèÜ Daily Routine</span>
                        <span class="badge">üíù Helpful Friend</span>
                        <span class="badge">üé® Creative Expression</span>
                    </div>
                    
                    <button class="btn" onclick="celebrateAchievement()" style="margin-top: 15px;">üéâ Celebrate!</button>
                    <div id="celebrationMessage" style="margin-top: 15px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Child Profile Modal -->
    <div id="childModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('childModal')">&times;</span>
            <h2>Create Child Profile</h2>
            <form id="childForm">
                <div class="form-group">
                    <label for="name">Child's Name:</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="age">Age:</label>
                    <input type="number" id="age" name="age" min="2" max="18" required>
                </div>
                <div class="form-group">
                    <label for="communication_level">Communication Level:</label>
                    <select id="communication_level" name="communication_level" required>
                        <option value="">Select Level</option>
                        <option value="minimal">Minimal (gestures, basic sounds)</option>
                        <option value="emerging">Emerging (few words, simple phrases)</option>
                        <option value="developing">Developing (short sentences, basic conversation)</option>
                        <option value="advanced">Advanced (complex communication)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="interests">Interests (comma-separated):</label>
                    <input type="text" id="interests" name="interests" placeholder="e.g., trains, music, drawing">
                </div>
                <div class="form-group">
                    <label for="special_needs">Special Considerations (comma-separated):</label>
                    <input type="text" id="special_needs" name="special_needs" placeholder="e.g., sensory sensitivities, routine preferences">
                </div>
                <button type="submit" class="btn">Create Profile</button>
            </form>
        </div>
    </div>

    <!-- About Modal -->
    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('aboutModal')">&times;</span>
            <h2>About Rainbow Bridge</h2>
            <p>Rainbow Bridge is a magical companion designed to support children with communication adventures! Our colorful world provides:</p>
            <ul style="margin: 20px 0; padding-left: 20px;">
                <li><strong>üåà Colorful Communication:</strong> Bright visual cards and symbols that make talking fun</li>
                <li><strong>üé® Creative Expression:</strong> Multiple ways to share thoughts and feelings</li>
                <li><strong>üè∞ Safe Adventures:</strong> Predictable, comfortable learning experiences</li>
                <li><strong>üåü Personal Growth:</strong> Celebrates every small step and achievement</li>
                <li><strong>üé™ Fun Learning:</strong> Playful activities that adapt to each child's unique style</li>
            </ul>
            <p>Rainbow Bridge creates a magical bridge between thoughts and words, helping every child find their unique voice in a world full of colors and possibilities!</p>
        </div>
    </div>

    <script>
        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        }

        // Child profile form submission
        document.getElementById('childForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            try {
                const response = await fetch('/api/child', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('Child profile created successfully!');
                    closeModal('childModal');
                    this.reset();
                    loadChildren();
                } else {
                    alert('Error creating profile: ' + result.error);
                }
            } catch (error) {
                alert('Error creating profile: ' + error.message);
            }
        });

        // Load children profiles
        async function loadChildren() {
            try {
                const response = await fetch('/api/children');
                const children = await response.json();
                
                const childrenList = document.getElementById('childrenList');
                
                if (children.length === 0) {
                    childrenList.innerHTML = '<p style="text-align: center; color: #666;">No children profiles found. Create a profile to get started!</p>';
                    return;
                }
                
                childrenList.innerHTML = children.map(child => `
                    <div class="child-card">
                        <h4>${child.name}</h4>
                        <p>Age: ${child.age} | Communication Level: ${child.communication_level}</p>
                        <a href="/child/${child.id}" class="btn">Open Dashboard</a>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading children:', error);
                document.getElementById('childrenList').innerHTML = '<p style="text-align: center; color: #666;">Error loading children profiles.</p>';
            }
        }

        // Load children on page load
        window.addEventListener('load', loadChildren);

        // Enhanced Demo Functions
        function startSmartScheduleDemo() {
            openModal('smartScheduleModal');
        }

        function startCommunicationDemo() {
            openModal('communicationModal');
        }

        function startRoutineDemo() {
            openModal('routineModal');
            resetRoutine();
        }

        function startProgressDemo() {
            openModal('progressModal');
        }

        // Smart Schedule Demo
        function generateDemoSchedule() {
            const request = document.getElementById('scheduleRequest').value;
            const resultDiv = document.getElementById('scheduleResult');
            
            if (!request.trim()) {
                resultDiv.innerHTML = '<p style="color: #ff6b6b;">Please enter a request first!</p>';
                return;
            }

            resultDiv.innerHTML = '<p>ü§ñ Creating your perfect schedule...</p>';
            
            setTimeout(() => {
                const schedules = {
                    'morning': [
                        { time: '7:30 AM', activity: 'üåÖ Gentle Wake-up Routine' },
                        { time: '8:00 AM', activity: 'ü•û Peaceful Breakfast' },
                        { time: '8:30 AM', activity: 'üßò Mindful Breathing' },
                        { time: '9:00 AM', activity: 'üìö Quiet Reading Time' }
                    ],
                    'afternoon': [
                        { time: '1:00 PM', activity: 'üçé Healthy Lunch' },
                        { time: '1:30 PM', activity: 'üé® Creative Art Time' },
                        { time: '2:30 PM', activity: 'üå≥ Nature Walk' },
                        { time: '3:30 PM', activity: 'üéµ Music & Movement' }
                    ],
                    'evening': [
                        { time: '6:00 PM', activity: 'üçΩÔ∏è Family Dinner' },
                        { time: '7:00 PM', activity: 'üéÆ Gentle Play Time' },
                        { time: '8:00 PM', activity: 'üìñ Bedtime Story' },
                        { time: '8:30 PM', activity: 'üò¥ Sleep Preparation' }
                    ]
                };

                let selectedSchedule = schedules.morning;
                if (request.toLowerCase().includes('afternoon')) selectedSchedule = schedules.afternoon;
                if (request.toLowerCase().includes('evening') || request.toLowerCase().includes('night')) selectedSchedule = schedules.evening;

                const scheduleHtml = selectedSchedule.map(item => 
                    `<div class="schedule-item"><span class="time">${item.time}</span><span class="activity">${item.activity}</span></div>`
                ).join('');

                resultDiv.innerHTML = `
                    <h4>‚ú® Your Personalized Schedule</h4>
                    <div class="demo-preview">${scheduleHtml}</div>
                    <p style="color: #50c878; font-weight: bold;">üéâ Perfect! This schedule is designed just for you!</p>
                `;
            }, 2000);
        }

        // Communication Demo
        function playCardSound(emotion) {
            const feedback = document.getElementById('cardFeedback');
            const responses = {
                'happy': 'üòä Great! You\'re feeling happy! That makes me happy too!',
                'sad': 'üò¢ I see you\'re feeling sad. Would you like a gentle hug? ü§ó',
                'hungry': 'üçé You\'re hungry! Let\'s find something yummy to eat!',
                'tired': 'üò¥ You look tired. Maybe it\'s time for a cozy rest?',
                'play': 'üéÆ You want to play! What would be fun to do together?',
                'help': 'ü§ù You need help! I\'m here for you. What can I do?'
            };

            feedback.innerHTML = `<p style="color: #4a90e2; font-weight: bold;">${responses[emotion]}</p>`;
            
            // Add visual feedback
            const cards = document.querySelectorAll('.comm-card');
            cards.forEach(card => card.style.transform = 'scale(1)');
            event.target.style.transform = 'scale(1.2)';
            
            setTimeout(() => {
                event.target.style.transform = 'scale(1)';
            }, 1000);
        }

        // Routine Demo
        let completedSteps = 0;
        const totalSteps = 4;

        function completeStep(stepElement) {
            if (stepElement.classList.contains('completed')) return;
            
            stepElement.classList.add('completed');
            stepElement.style.background = '#d4edda';
            stepElement.style.color = '#155724';
            stepElement.querySelector('span').innerHTML = '‚úÖ';
            
            completedSteps++;
            updateRoutineProgress();
            
            if (completedSteps === totalSteps) {
                setTimeout(() => {
                    alert('üéâ Wonderful! You completed your bedtime routine! Sweet dreams! üåô');
                }, 500);
            }
        }

        function updateRoutineProgress() {
            const percentage = (completedSteps / totalSteps) * 100;
            const progressFill = document.getElementById('routineProgressFill');
            const progressText = document.getElementById('routineProgressText');
            
            progressFill.style.width = percentage + '%';
            progressText.textContent = Math.round(percentage) + '% Complete';
            
            if (percentage === 100) {
                progressText.textContent = 'üéâ All Done!';
            }
        }

        function resetRoutine() {
            completedSteps = 0;
            const steps = document.querySelectorAll('#routineSteps .step');
            steps.forEach(step => {
                step.classList.remove('completed');
                step.style.background = 'white';
                step.style.color = '#555';
                step.querySelector('span').innerHTML = '‚≠ï';
            });
            updateRoutineProgress();
        }

        // Progress Demo
        function celebrateAchievement() {
            const messageDiv = document.getElementById('celebrationMessage');
            const celebrations = [
                'üéâ Amazing progress! You\'re doing so well!',
                '‚≠ê Look how much you\'ve grown! I\'m proud of you!',
                'üåà Every step forward is a victory! Keep shining!',
                'üèÜ You\'re becoming more confident every day!',
                'üí´ Your hard work is paying off beautifully!'
            ];
            
            const randomCelebration = celebrations[Math.floor(Math.random() * celebrations.length)];
            messageDiv.innerHTML = `<p style="color: #4a90e2; font-weight: bold; font-size: 1.1rem; animation: gentle-bounce 1s ease-in-out;">${randomCelebration}</p>`;
            
            // Add confetti effect
            setTimeout(() => {
                messageDiv.innerHTML += '<div style="text-align: center; font-size: 2rem; animation: gentle-bounce 2s ease-in-out;">üéäüéàüåüüéäüéà</div>';
            }, 1000);
        }
    </script>
</body>
</html>
